// =============================================================================
// Layout.scss
// -----------------------------------------------------------------------------
// This file defines the top-level page layout for the site, defined as rules
// targeting the .quire class which has been applied to the <body>. Modifier
// classes like .no-js are also supported. Has the following components:
//
// - .quire: base container class applied to body; gets .no-js modifier if no
//     JS support is detected.
// - .quire.no-js: modifier class
//
// - .quire__primary: The container for main content elements (including nav)
// - .quire__secondary: the container for the site menu (which contains a
//     standard Bulma .menu component). When JS is not supported this element
//     sits at the bottom of the page via Flexbox. When JS is available, this
//     element is positioned absolutely and shifted out of the viewport until
//     it is toggled.
// - .quire__secondary.is-expanded: modifier class
//
// - .visually-hidden: A utility class to hide accessibility-related content
//     without obscuring it from screen readers, etc.

// scss-lint:disable NameFormat

// Default values
// -----------------------------------------------------------------------------
// Override these values in the main application.scss file in the variables
// section.

$quire-menu-background-color: #333 !default;
$quire-menu-width: 350px !default;

// .quire container
// -----------------------------------------------------------------------------
.quire {
  width: 100%;

  // Styles used whether JS is enabled or not
  &__secondary {
    background-color: $quire-menu-background-color;
    padding: 1em;

    * { color: findColorInvert($quire-menu-background-color); }

    a {
      background-color: $quire-menu-background-color;
      color: findColorInvert($quire-menu-background-color);

      &:hover {
        color: findColorInvert($quire-menu-background-color);
        background-color: darken($quire-menu-background-color, 5%);
      }
    }
  }

  // Styles when JS is not supported; menu at bottom
  &.no-js {
    display: flex;
    flex-direction: column;
    min-height: 100vh;

    .quire__primary { flex: 1; }

    .quire__secondary {
      order: 1;
      width: 100%;
    }
  }

  // Styles with JS enabled (sliding menu, etc.)
  &:not(.no-js) {
    .quire__primary {
      display: flex;
      flex-direction: column;
      height: 100vh;
      left: 0;
      position: absolute;
      transition: all 0.15s ease-in-out;
      width: 100%;

      &__inner {
        flex: 1 1 auto;
        -webkit-overflow-scrolling: touch;
        overflow-y: scroll;
        position: relative;
      }

      .quire-navbar { flex: 0 0 auto; }
    }

    .quire__secondary {
      height: 100%;
      overflow: hidden;
      position: fixed;
      top: 0;
      transform: translateX(-($quire-menu-width));
      transition: all 0.15s ease-in-out;
      width: $quire-menu-width;
      z-index: 1100;

      &.is-expanded { transform: translateX(0); }

      &.is-expanded + .quire__primary {
        left: $quire-menu-width;
        width: calc(100% - #{$quire-menu-width});
      }
    }
  }
}

.visually-hidden {
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  overflow: hidden;
  position: absolute;
  width: 1px;
}

// Print overrides
// scss-lint:disable ImportantRule
@media print {
  .quire {
    &__primary {
      display: block !important;
      height: 100%;
    }

    &__secondary { display: none; }
  }
}


