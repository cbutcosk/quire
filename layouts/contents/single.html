{{/*
  Table of Contents (TOC) page template. Page content from the markdown will
  appear in the .Content outlet below. The Table of Contents list will appear
  below that. It is scoped to show the contents of the full site. Pages can be
  removed from the TOC indivudally by adding "toc: false" to the page yaml.
*/}}

{{ define "main" }}
<div class="quire-contents" id="main" role="main">
  <div class="quire-contents-header">
    <h1>{{ .Title | markdownify }}</h1>
  </div>
  <section class="section quire-page__content" id="content">
    <div class="container {{ if in .Params.class "grid" }}is-fullhd{{ end }}">
      <div class="content">
        {{ .Content }}
      </div>

      <div class="quire-contents-list {{ if in .Params.class "grid" }} grid{{ else if in .Params.class "abstract" }} abstract{{ else if in .Params.class "brief" }} brief{{ else }} list{{ end }}">
        <div class="menu-list">
          <ul class="contents">
            {{ if .Section }}
              {{ $scope := where .Site.Pages "Section" .Section }}
              {{- partial "contents-list.html" (dict "contentsScope" $scope "contentsType" .Site.Params.tocType "contentsLocation" ".Params.toc" "contentsPage" . ) -}}
            {{ else }}
              <!-- {{ $scope := .Site.Pages }} -->
              <!-- {{- partial "contents-list.html" (dict "contentsScope" $scope "contentsType" .Site.Params.tocType "contentsLocation" ".Params.toc" "contentsPage" . ) -}} -->
              <ul class="contents-menu">
                <nav class="quire-contents-menu menu-list" role="navigation" aria-label="full">
                  <h3 class="visually-hidden">Table of Contents</h3>
                  <div class="quire-menu__formats">
                    <h3 class="menu-lable">Intro</h3>
                    <div aria-label="intro">
                      {{ $scope := where .Site.Pages "Section" .Section }}
                      {{- partial "arrow-list.html" (dict "contentsScope" $scope "contentsType" .Site.Params.tocType "contentsLocation" ".Params.menu" "contentsPage" . ) -}}
                    </div>
                  </div>
                  <div class="quire-menu__formats">
                    <h3 class="menu-lable">Main</h3>
                    <div aria-label="intro">
                      {{ $scope := .Site.Pages }}
                      {{- partial "arrow-list.html" (dict "contentsScope" $scope "contentsType" .Site.Params.tocType "contentsLocation" ".Params.contents" "contentsPage" . ) -}}
                    </div>
                  </div>
                </nav>

                {{ if isset .Site.Data.publication "resource_link" -}}
                  {{ $otherFormats := where .Site.Data.publication.resource_link "type" "other-format" }}
                  {{ $relatedResources := where .Site.Data.publication.resource_link "type" "related-resource" }}
                  {{ if gt (len $relatedResources) 0 -}}
                    <div class="quire-menu__formats">
                    <h3 class="menu-label">Resources</h3>
                      <div role="complementary" aria-label="related resources">
                        {{- partial "link-list-arrow.html" $relatedResources -}}
                      </div>
                    </div>
                  {{ end -}}
                  {{ if gt (len $otherFormats) 0 -}}
                    <div class="quire-menu__formats">
                    <h3 class="menu-label">Other Formats</h3>
                      <div role="complementary" aria-label="downloads">
                        {{- partial "link-list-arrow.html" $otherFormats -}}
                      </div>
                    </div>
                  {{ end -}}
                {{ end -}}
              </ul>
            {{ end }}
        </div>
      </div>
      <div class="buttons">
        <ul class="contents-buttons">
          <li class="quire-nav-button">
            {{ with .Prev }}
              <a href="{{ .Permalink }}">Previous</a>
              <span class="visually-hidden">Previous Page (left keyboard arrow or swipe)</span>
            {{ end }}
          </li>
          <li class="quire-nav-button">
            {{ with .Next }}
              <a href="{{ .Permalink }}">Next</a>
              <span class="visually-hidden">Next Page (right keyboard arrow or swipe)</span>
            {{ end }}
          </li>
        </ul>
      </div>
    </div>
  </section>
</div>
{{ end }}
