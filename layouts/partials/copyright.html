{{ if isset $.Site.Params "imagedir" }}
{{ $.Scratch.Set "imageDir" $.Site.Params.imageDir }}
{{ else }}
{{ $.Scratch.Set "imagedir" "" }}
{{ end }}

<div class="quire-copyright">

{{/* If copyright info is defined, show information about it here */}}
{{- if .Site.Data.publication.copyright -}}
  <p>{{ .Site.Data.publication.copyright }}.</p>
  {{- end -}}

  {{/* If a license is defined, show information about it here */}}
  {{- if .Site.Data.publication.license.name -}}

  {{/* License icons (ex. CC icons) if any */}}
  {{- if .Site.Data.publication.license.icon -}}
  {{- $imgPath := printf "%s/%s" ($.Scratch.Get "imageDir") .Site.Data.publication.license.icon -}}
  <img src="{{ $imgPath | absURL }}"
      class="quire-copyright__icon"
      alt="logo for {{ .Site.Data.publication.license.name }}" />
  {{- end -}}

  {{/* License details */}}

    {{ if .Site.Data.publication.license.online_text }}
      <div class="is-screen-only">
      {{ .Site.Data.publication.license.online_text | markdownify }}
      </div>
    {{ else }}
      <div class="is-screen-only">
      {{ template "copyright-generator" . }}
      </div>
    {{ end }}

    {{ if .Site.Data.publication.license.pdf_ebook_text }}
      <div class="is-print-only">
      {{ .Site.Data.publication.license.pdf_ebook_text | markdownify }}
      </div>
    {{ else }}
      <div class="is-print-only">
      {{ template "copyright-generator" . }}
      </div>
    {{ end }}

{{- end -}}

</div>


{{ define "copyright-generator" }}

{{- if eq .Site.Data.publication.license.scope "some-exceptions" -}}
  Except where otherwise noted, this work is licensed under a
  {{ with .Site.Data.publication.license.url }}<a rel="license" href="{{ . }}">{{ end }}
  {{ .Site.Data.publication.license.name }}
  {{ with .Site.Data.publication.license.url }}</a>{{ end }}.

{{- else if eq .Site.Data.publication.license.scope "text-only" -}}
  The text of this work is licensed under a
  {{ with .Site.Data.publication.license.url }}<a rel="license" href="{{ . }}">{{ end }}
  {{ .Site.Data.publication.license.name }}
  {{ with .Site.Data.publication.license.url }}</a>{{ end }}
  . Unless otherwise noted, all illustrations are excluded from the
  {{ if .Site.Data.publication.license.abbreviation }}
  {{ .Site.Data.publication.license.abbreviation }}
  {{ else }}
  {{ .Site.Data.publication.license.name }}
  {{ end }} license.
{{- else -}}
  This work is licensed under a
  {{ with .Site.Data.publication.license.url }}<a rel="license" href="{{ . }}">{{ end }}
  {{ .Site.Data.publication.license.name }}
  {{ with .Site.Data.publication.license.url }}</a>{{ end }}
{{- end -}}
<span class="is-print-only">
  To view a copy of this license{{ with .Site.Data.publication.license.url }},
  visit {{ . }} or{{ end }}
  send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042.
</span>

{{ end }}
